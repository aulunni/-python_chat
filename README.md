# Проектное задание
Проект по "Основы программирования на Python", 2 семестр.

Перед нами стояла задача написать чат, в котором будут:
1) Список пользователей;
2) Личное общение между пользователями;
3) При подключении к серверу пользователь видел список - других клиентов в сети для выбора общения.

# Демо представление

# Описание работы проекта

В поставленном нам задании необходимо написать *клиентскую часть*, где пользователи смогут передавать друг другу сообщения и *серверную часть*, которая будет обрабатывать все запросы, переводя их в техническую информацию.

**_Стэк проекта_**:

Основной "костыль" - модули *socket* и *threading*. 

Для работы со словарями (т.к. передается не текст) используется модуль *JSON*.

Также чат работает на протоколе TCP. Можно, конечно, использовать протокол UDP, но это менее надежно.

# Теоретическая часть

Для начала разберем костыли:

**Socket - это программный интерфейс для обеспечения информационного обмена между процессами.**

Сокеты бывают серверные (принимают сообщения) и клиентские (отправляют сообщения), нам нужно использовать и те, и другие. Сокет состоит из IP-адреса и порта. Для работы с сокетами в Python используется одноименная библиотека.

Сокеты являются конечной точкой двунаправленного канала связи между сервером и клиентом. Они могут обмениваться данными внутри процесса, между процессами на одной машине или между процессами на разных машинах. Для любого взаимодействия с удаленной программой мы должны подключаться через порт сокета.

**Threading - модуль для реализации многопоточности в программах.**

Нам необходима именно многопоточная программа, а не мультипроцессорная. У них похожие концепты, но реализация разная: потоки имеют общую память, поэтому меняя один поток - изменятся и другие. А процессы в свою очередь используют разную память.

Threading также нужен для того, чтобы обрабатывать поток входящих сообщений и для возможности ввода.

Перейдем к другому вопросу!

# Уникальность моего проекта или зачем использовать JSON?

**JSON (JavaScript Object Notation) - это текстовый формат для хранения и обмена данными.**

В своих сообщениях мы передаем не просто текст. Удивительно, да? В сообщении передается словарь, в котором основной ключ "action" - то есть и сервер, и клиент сначала определяют, что именно хотят с ними сделать. 

Передать словарь по сокету нельзя :( *Можно, но тяжело...*

Поэтому JSON используется для того, чтобы на одной стороне сделать из словаря строку, а на другой стороне - из строки словарь. Без каких-либо потерь, ошибок и остального.

*Синтаксис JSON похож на Python, его легко воспринимать, поэтому писать было довольно несложно!*

**Какие модули я использовала?**

Для записи в JSON используется модуль dump(s). Dump записывает объект Python в файл в формате JSON, а dumpS возвращает строку в формате JSON.

Чтение JSON из файла такое же простое, как и запись. С помощью библиотеки json мы можем спарсить JSON-строку прямо из файла. Для этого используем json.load. Это очень важный метод. С его помощью происходит чтение файла, парс JSON-данных. После этого все данные записываются в словарь и возвращаются к нам. 

Как и у json.dump, у json.load есть дополнительный метод. Он позволяет работать со строками напрямую, ведь чаще всего у нас не будет файлоподобного объекта, содержащего JSON. Как вы уже догадались, называется он json.loadS.

# Практическая часть

**Запуск работы**

Чтобы запустить необходимо:

```
python3 *название_сервера*.py
```

```
python3 *название_клиента*.py
```

**Сервер**

```
# подключение пользователя к серверу
CONNECTION_LIST = []
USERS = {}
RECV_BUFFER = 4096
PORT = 8888

# функция, которая выводит отправленные клиентом сообщения в терминал сервера
def main():

# регистрация пользователя
def registration(sock, msg):

# появление нового пользователя
def new_user(sock, msg):

# отключение пользователя
def user_left(sock):

# отправка сообщения в общий чат
def new_message(sock, msg):

# новое личное сообщение
def new_whisper(sock, msg):

# модуль вызова
if __name__ == '__main__':
    main()
```

**Клиент**

```
# подключение к серверу
HOST = '127.0.0.1'
PORT = 8888

# функция для получений сообщений от сервера
def recv_from_server():

# функция для отправки сообщений серверу
def send_to_server(name):

# регистрация пользователя
def registration():

# вызов
if __name__ == '__main__':
```

## Вывод

Благодаря этому проекту мы научились работать оформлением кода, научились понимать его структуру и важность последовательности. Мы применили знания, полученные на потрясающих семинарах в феврале 2022 года, а также все, что смогли узнать в первом семестре. Поработали с модулями socket, threading и json, которые помогли достичь поставленную цель - написать чат для юзеров на python. Проект стал высокоэффективен, ведь когда еще я бы провела три дня исключительно программируя! Удалось реализовать все поставленные задачи: личный и общий чаты, список пользователей, надежный обмен сообщений. 

Всем, кто хочет в будущем также написать собственный чат на Python, рекомендую изменить свои желания и мечты, чтобы не столкнуться с проблемами, которые возникли на пути кодинга. Если вы все же решили идти до конца, то не забывайте пить много воды, смотреть в окно (и обдумывать свои решения ещё раз), выходить иногда трогать траву и дышать свежим воздухом, чтобы осознать - проблема не в коде, а в вас.
